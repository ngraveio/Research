# Batch signing Protocol

## NBCR-2025-001

© 2025 NGRAVE <br/>
Authors: Mathieu Da Silva <br/>
Date: March 17, 2025

---

# I - Introduction

In the evolving landscape of cryptocurrency and blockchain technology, secure and efficient communication between offline signers and watch-only wallets remains a critical challenge. While existing protocols, as described in [[NBCR-2023-003]](https://github.com/ngraveio/Research/blob/main/papers/nbcr-2023-003-sign.md) have laid the groundwork for signing individual transactions using Uniform Resource Types (UR Types) communicated through QR codes, there is a notable gap in the standardization of batch transaction signing. When signing multiple transactions in a row, individually scanning each sign request with the offline signer and each signature with the watch-only wallet reduces the usability of QR communication, which can become a barrier to the adoption of airgapped wallets.

This paper addresses this gap by introducing new UR types specifically designed for batch transaction signing through QR communication. By leveraging UR Types, we aim to facilitate seamless and standardized communication between airgapped wallets, ensuring usability and security of offline transaction signing processes.

This paper delves into the technical details, use cases, and security considerations of implementing batch transaction signing using UR Types. It provides a comprehensive guide for developers and users alike, ensuring that the proposed methods can be integrated into existing systems with minimal effort. 

---

# II - Batch signing

The batch signing process follows the described operations:

1. The watch-only wallet creates the multiple transactions to sign and aggregate them into a batch.
2. The watch-only wallet encodes the batch request using the UR type `batch-sign-request` defined in this document.
3. The user scans the QR code containing the batch request with the offline signer.
4. The users signs each transaction contained in the batch after reviewing thoroughly their content.
5. The offline signer prepares the batch response using the UR type `batch-sign-response` defined in this document.
6. The user scans with the watch-only wallet the batch response. 
7. The watch-only wallet broadcasts the transactions.

The UR types registry for batch signing is given thereafter.


## Batch signing UR types registry

This document aims to propose blockchain-agnostic UR types for batch signing transactions by extending the UR types `sign-request` (tagged with #6.41411) and `sign-response` (tagged with #6.41412), defined in [[NBCR-2023-003]](https://github.com/ngraveio/Research/blob/main/papers/nbcr-2023-003-sign.md).

- **CDDL for `batch-sign-request`**

When embedded in another UR type, `batch-sign-request` is tagged with #6.41413.

```
; request-id inside each #6.41411(sign-request) must be specified to identify each transaction in the batch

batch-sign-request = {
    batch-sign: [+ #6.41411(sign-request)]
}

batch-sign = 1
```

- **CDDL for `batch-sign-response`**

When embedded in another UR type, `batch-sign-response` is tagged with #6.41414.

```
; request-id inside each #6.41412(sign-response) must be specified to identify the corresponding signature in the batch

batch-sign-response = {
    batch-signature: [+ #6.41412(sign-response)]
}

batch-signature = 1
```

## Use case and example

A compelling use case for batch signing is the simultaneous signing of multiple Partially Signed Bitcoin Transactions (PSBTs). For instance, staking BTC on the Babylon protocol [[Babylon/docs/register-bitcoin-stake]](https://github.com/babylonlabs-io/babylon/blob/main/docs/register-bitcoin-stake.md) involves signing three distinct PSBTs: one for staking, one for slashing, and another for unbinding slashing. Instead of signing each transaction individually, which would require scanning multiple QR codes sequentially, the user can streamline the process by scanning a single QR code that encapsulates the entire batch of transactions.

The following example demonstrates how batch signing can be efficiently applied to these three PSBTs, enhancing both convenience and security by reducing the number of interactions required.

### BTC batch signing request

- BTC PSBTs

```
PSBT 1:
0x70736274ff010089020000000144a549ead63ac9c6987b90669208ece5e93f28de4b1f97b5e4036c995f47b3d50100000000ffffffff0250c3000000000000225120a80fe5278c52cab2e0a0c9702713f61fe8f2f248346a6d7dcc1245338c14ec1609dd06000000000022512074aa0a4aeefc052d0e63edda5a5f9cd4a9a6b245fad33ea29408c130e2916041000000000001012b31a507000000000022512074aa0a4aeefc052d0e63edda5a5f9cd4a9a6b245fad33ea29408c130e2916041011720bd2eb288281a9e7a15ec81b8b593f243b96fbcd2b16a1a509c1b87df95fc499c000000

PSBT 2:
0x70736274ff01007d02000000017b3897f29ddb41a6c5f304ac8a078b6575fb6d0584a50f8bb9c8f8f046b1bf520000000000ffffffff02c4090000000000001600145be12624d08a2b424095d7c07221c33450d14bf104a60000000000002251208d50aed5bc9d2e62d65e27af2bc7a424ac1906dd2dc7a29b3d88b8c7bd5026e0000000000001012b50c3000000000000225120a80fe5278c52cab2e0a0c9702713f61fe8f2f248346a6d7dcc1245338c14ec164215c050929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0089a5f44e98c08db22bb0f07e05678d015b479990161599e05c331363c9c67fefd790120bd2eb288281a9e7a15ec81b8b593f243b96fbcd2b16a1a509c1b87df95fc499cad20d23c2c25e1fcf8fd1c21b9a402c19e2e309e531e45e92fb1e9805b6056b0cc76ad200aee0509b16db71c999238a4827db945526859b13c95487ab46725357c9a9f25ac20113c3a32a9d320b72190a04a020a0db3976ef36972673258e9a38a364f3dc3b0ba2017921cf156ccb4e73d428f996ed11b245313e37e27c978ac4d2cc21eca4672e4ba203bb93dfc8b61887d771f3630e9a63e97cbafcfcc78556a474df83a31a0ef899cba2040afaf47c4ffa56de86410d8e47baa2bb6f04b604f4ea24323737ddc3fe092dfba2079a71ffd71c503ef2e2f91bccfc8fcda7946f4653cef0d9f3dde20795ef3b9f0ba20d21faf78c6751a0d38e6bd8028b907ff07e9a869a43fc837d6b3f8dff6119a36ba20f5199efae3f28bb82476163a7e458c7ad445d9bffb0682d10d3bdb2cb41f8e8eba20fa9d882d45f4060bdb8042183828cd87544f1ea997380e586cab77d5fd698737ba569cc001172050929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0000000

PSBT 3:
0x70736274ff01007d02000000017b7b276f516e307c2684b9b52ee7ef476bc1f52170b02fa1df0dda39b60d51a50000000000ffffffff0260090000000000001600145be12624d08a2b424095d7c07221c33450d14bf1989e0000000000002251208d50aed5bc9d2e62d65e27af2bc7a424ac1906dd2dc7a29b3d88b8c7bd5026e0000000000001012b80bb000000000000225120925f6e5d2f54928dbbf7c7b989e2d0e8b6023baece6b7ae6efed0c4f548919994215c050929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac08418260aca037f78aa845243f0e2e4c201f3360266f71c130a21535e670351f9fd790120bd2eb288281a9e7a15ec81b8b593f243b96fbcd2b16a1a509c1b87df95fc499cad20d23c2c25e1fcf8fd1c21b9a402c19e2e309e531e45e92fb1e9805b6056b0cc76ad200aee0509b16db71c999238a4827db945526859b13c95487ab46725357c9a9f25ac20113c3a32a9d320b72190a04a020a0db3976ef36972673258e9a38a364f3dc3b0ba2017921cf156ccb4e73d428f996ed11b245313e37e27c978ac4d2cc21eca4672e4ba203bb93dfc8b61887d771f3630e9a63e97cbafcfcc78556a474df83a31a0ef899cba2040afaf47c4ffa56de86410d8e47baa2bb6f04b604f4ea24323737ddc3fe092dfba2079a71ffd71c503ef2e2f91bccfc8fcda7946f4653cef0d9f3dde20795ef3b9f0ba20d21faf78c6751a0d38e6bd8028b907ff07e9a869a43fc837d6b3f8dff6119a36ba20f5199efae3f28bb82476163a7e458c7ad445d9bffb0682d10d3bdb2cb41f8e8eba20fa9d882d45f4060bdb8042183828cd87544f1ea997380e586cab77d5fd698737ba569cc001172050929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0000000
```

- CBOR diagnosis format

```
{ 1: [ 41411({1: 37(h'3B5414375E3A450B8FE1251CBC2B3FB5'), ; request-id for PSBT 1
              2: 41401( ; #6.41401(coin-identity)
                    {1: 8, ; secp256k1 curve
                     2: 0}), ; Bitcoin BIP44
              3: 40304({1: [84, true, 0, true, 0, true], ; #6.40304(keypath) m/84'/0'/0'
                       2: 934670036}), ; master fingerprint
              4: h'70736274ff010089020000000144a549ead63ac9c6987b90669208ece5e93f28de4b1f97b5e4036c995f47b3d50100000000ffffffff0250c3000000000000225120a80fe5278c52cab2e0a0c9702713f61fe8f2f248346a6d7dcc1245338c14ec1609dd06000000000022512074aa0a4aeefc052d0e63edda5a5f9cd4a9a6b245fad33ea29408c130e2916041000000000001012b31a507000000000022512074aa0a4aeefc052d0e63edda5a5f9cd4a9a6b245fad33ea29408c130e2916041011720bd2eb288281a9e7a15ec81b8b593f243b96fbcd2b16a1a509c1b87df95fc499c000000', ; PSBT 1
              5: "NGRAVE"}), ; wallet name
       41411({1: 37(h'177ce9c9328e856be8a4b87d40793e16'), ; request-id for PSBT 2
              2: 41401( ; #6.41401(coin-identity)
                    {1: 8, ; secp256k1 curve
                     2: 0}), ; Bitcoin BIP44
              3: 40304({1: [84, true, 0, true, 0, true], ; #6.40304(keypath) m/84'/0'/0'
                       2: 934670036}), ; master fingerprint
              4: h'70736274ff01007d02000000017b3897f29ddb41a6c5f304ac8a078b6575fb6d0584a50f8bb9c8f8f046b1bf520000000000ffffffff02c4090000000000001600145be12624d08a2b424095d7c07221c33450d14bf104a60000000000002251208d50aed5bc9d2e62d65e27af2bc7a424ac1906dd2dc7a29b3d88b8c7bd5026e0000000000001012b50c3000000000000225120a80fe5278c52cab2e0a0c9702713f61fe8f2f248346a6d7dcc1245338c14ec164215c050929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0089a5f44e98c08db22bb0f07e05678d015b479990161599e05c331363c9c67fefd790120bd2eb288281a9e7a15ec81b8b593f243b96fbcd2b16a1a509c1b87df95fc499cad20d23c2c25e1fcf8fd1c21b9a402c19e2e309e531e45e92fb1e9805b6056b0cc76ad200aee0509b16db71c999238a4827db945526859b13c95487ab46725357c9a9f25ac20113c3a32a9d320b72190a04a020a0db3976ef36972673258e9a38a364f3dc3b0ba2017921cf156ccb4e73d428f996ed11b245313e37e27c978ac4d2cc21eca4672e4ba203bb93dfc8b61887d771f3630e9a63e97cbafcfcc78556a474df83a31a0ef899cba2040afaf47c4ffa56de86410d8e47baa2bb6f04b604f4ea24323737ddc3fe092dfba2079a71ffd71c503ef2e2f91bccfc8fcda7946f4653cef0d9f3dde20795ef3b9f0ba20d21faf78c6751a0d38e6bd8028b907ff07e9a869a43fc837d6b3f8dff6119a36ba20f5199efae3f28bb82476163a7e458c7ad445d9bffb0682d10d3bdb2cb41f8e8eba20fa9d882d45f4060bdb8042183828cd87544f1ea997380e586cab77d5fd698737ba569cc001172050929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0000000', ; PSBT 2
              5: "NGRAVE"}), ; wallet name
       41411({1: 37(h'91392cee288586fbce25e7ac3d56b580'), ; request-id for PSBT 3
              2: 41401( ; #6.41401(coin-identity)
                    {1: 8, ; secp256k1 curve
                     2: 0}), ; Bitcoin BIP44
              3: 40304({1: [84, true, 0, true, 0, true], ; #6.40304(keypath) m/84'/0'/0'
                       2: 934670036}), ; master fingerprint
              4: h'70736274ff01007d02000000017b7b276f516e307c2684b9b52ee7ef476bc1f52170b02fa1df0dda39b60d51a50000000000ffffffff0260090000000000001600145be12624d08a2b424095d7c07221c33450d14bf1989e0000000000002251208d50aed5bc9d2e62d65e27af2bc7a424ac1906dd2dc7a29b3d88b8c7bd5026e0000000000001012b80bb000000000000225120925f6e5d2f54928dbbf7c7b989e2d0e8b6023baece6b7ae6efed0c4f548919994215c050929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac08418260aca037f78aa845243f0e2e4c201f3360266f71c130a21535e670351f9fd790120bd2eb288281a9e7a15ec81b8b593f243b96fbcd2b16a1a509c1b87df95fc499cad20d23c2c25e1fcf8fd1c21b9a402c19e2e309e531e45e92fb1e9805b6056b0cc76ad200aee0509b16db71c999238a4827db945526859b13c95487ab46725357c9a9f25ac20113c3a32a9d320b72190a04a020a0db3976ef36972673258e9a38a364f3dc3b0ba2017921cf156ccb4e73d428f996ed11b245313e37e27c978ac4d2cc21eca4672e4ba203bb93dfc8b61887d771f3630e9a63e97cbafcfcc78556a474df83a31a0ef899cba2040afaf47c4ffa56de86410d8e47baa2bb6f04b604f4ea24323737ddc3fe092dfba2079a71ffd71c503ef2e2f91bccfc8fcda7946f4653cef0d9f3dde20795ef3b9f0ba20d21faf78c6751a0d38e6bd8028b907ff07e9a869a43fc837d6b3f8dff6119a36ba20f5199efae3f28bb82476163a7e458c7ad445d9bffb0682d10d3bdb2cb41f8e8eba20fa9d882d45f4060bdb8042183828cd87544f1ea997380e586cab77d5fd698737ba569cc001172050929b74c1a04954b78b4b6035e97a5e078a5a0f28ec96d547bfee9ace803ac0000000', ; PSBT 3
              5: "NGRAVE"}) ; wallet name
]}
```

- CBOR encoding

```
A1                                      # map(1)
   01                                   # unsigned(1)
   83                                   # array(3)
      D9 A1C3                           # tag(41411)
         A5                             # map(5)
            01                          # unsigned(1)
            D8 25                       # tag(37)
               50                       # bytes(16)
                  3B5414375E3A450B8FE1251CBC2B3FB5 
            02                          # unsigned(2)
            D9 A1B9                     # tag(41401)
               A2                       # map(2)
                  01                    # unsigned(1)
                  08                    # unsigned(8)
                  02                    # unsigned(2)
                  00                    # unsigned(0)
            03                          # unsigned(3)
            D9 9D70                     # tag(40304)
               A2                       # map(2)
                  01                    # unsigned(1)
                  86                    # array(6)
                     18 54              # unsigned(84)
                     F5                 # primitive(21)
                     00                 # unsigned(0)
                     F5                 # primitive(21)
                     00                 # unsigned(0)
                     F5                 # primitive(21)
                  02                    # unsigned(2)
                  1A 37B5EED4           # unsigned(934670036)
            04                          # unsigned(4)
            58 E6                       # bytes(230)
               70736274FF010089020000000144A549EAD63AC9C6987B90669208ECE5E93F28DE4B1F97B5E4036C995F47B3D50100000000FFFFFFFF0250C3000000000000225120A80FE5278C52CAB2E0A0C9702713F61FE8F2F248346A6D7DCC1245338C14EC1609DD06000000000022512074AA0A4AEEFC052D0E63EDDA5A5F9CD4A9A6B245FAD33EA29408C130E2916041000000000001012B31A507000000000022512074AA0A4AEEFC052D0E63EDDA5A5F9CD4A9A6B245FAD33EA29408C130E2916041011720BD2EB288281A9E7A15EC81B8B593F243B96FBCD2B16A1A509C1B87DF95FC499C000000 
            05                          # unsigned(5)
            66                          # text(6)
               4E4752415645             # "NGRAVE"
      D9 A1C3                           # tag(41411)
         A5                             # map(5)
            01                          # unsigned(1)
            D8 25                       # tag(37)
               50                       # bytes(16)
                  177CE9C9328E856BE8A4B87D40793E16 
            02                          # unsigned(2)
            D9 A1B9                     # tag(41401)
               A2                       # map(2)
                  01                    # unsigned(1)
                  08                    # unsigned(8)
                  02                    # unsigned(2)
                  00                    # unsigned(0)
            03                          # unsigned(3)
            D9 9D70                     # tag(40304)
               A2                       # map(2)
                  01                    # unsigned(1)
                  86                    # array(6)
                     18 54              # unsigned(84)
                     F5                 # primitive(21)
                     00                 # unsigned(0)
                     F5                 # primitive(21)
                     00                 # unsigned(0)
                     F5                 # primitive(21)
                  02                    # unsigned(2)
                  1A 37B5EED4           # unsigned(934670036)
            04                          # unsigned(4)
            59 0299                     # bytes(665)
               70736274FF01007D02000000017B3897F29DDB41A6C5F304AC8A078B6575FB6D0584A50F8BB9C8F8F046B1BF520000000000FFFFFFFF02C4090000000000001600145BE12624D08A2B424095D7C07221C33450D14BF104A60000000000002251208D50AED5BC9D2E62D65E27AF2BC7A424AC1906DD2DC7A29B3D88B8C7BD5026E0000000000001012B50C3000000000000225120A80FE5278C52CAB2E0A0C9702713F61FE8F2F248346A6D7DCC1245338C14EC164215C050929B74C1A04954B78B4B6035E97A5E078A5A0F28EC96D547BFEE9ACE803AC0089A5F44E98C08DB22BB0F07E05678D015B479990161599E05C331363C9C67FEFD790120BD2EB288281A9E7A15EC81B8B593F243B96FBCD2B16A1A509C1B87DF95FC499CAD20D23C2C25E1FCF8FD1C21B9A402C19E2E309E531E45E92FB1E9805B6056B0CC76AD200AEE0509B16DB71C999238A4827DB945526859B13C95487AB46725357C9A9F25AC20113C3A32A9D320B72190A04A020A0DB3976EF36972673258E9A38A364F3DC3B0BA2017921CF156CCB4E73D428F996ED11B245313E37E27C978AC4D2CC21ECA4672E4BA203BB93DFC8B61887D771F3630E9A63E97CBAFCFCC78556A474DF83A31A0EF899CBA2040AFAF47C4FFA56DE86410D8E47BAA2BB6F04B604F4EA24323737DDC3FE092DFBA2079A71FFD71C503EF2E2F91BCCFC8FCDA7946F4653CEF0D9F3DDE20795EF3B9F0BA20D21FAF78C6751A0D38E6BD8028B907FF07E9A869A43FC837D6B3F8DFF6119A36BA20F5199EFAE3F28BB82476163A7E458C7AD445D9BFFB0682D10D3BDB2CB41F8E8EBA20FA9D882D45F4060BDB8042183828CD87544F1EA997380E586CAB77D5FD698737BA569CC001172050929B74C1A04954B78B4B6035E97A5E078A5A0F28EC96D547BFEE9ACE803AC0000000 
            05                          # unsigned(5)
            66                          # text(6)
               4E4752415645             # "NGRAVE"
      D9 A1C3                           # tag(41411)
         A5                             # map(5)
            01                          # unsigned(1)
            D8 25                       # tag(37)
               50                       # bytes(16)
                  91392CEE288586FBCE25E7AC3D56B580 
            02                          # unsigned(2)
            D9 A1B9                     # tag(41401)
               A2                       # map(2)
                  01                    # unsigned(1)
                  08                    # unsigned(8)
                  02                    # unsigned(2)
                  00                    # unsigned(0)
            03                          # unsigned(3)
            D9 9D70                     # tag(40304)
               A2                       # map(2)
                  01                    # unsigned(1)
                  86                    # array(6)
                     18 54              # unsigned(84)
                     F5                 # primitive(21)
                     00                 # unsigned(0)
                     F5                 # primitive(21)
                     00                 # unsigned(0)
                     F5                 # primitive(21)
                  02                    # unsigned(2)
                  1A 37B5EED4           # unsigned(934670036)
            04                          # unsigned(4)
            59 0299                     # bytes(665)
               70736274FF01007D02000000017B7B276F516E307C2684B9B52EE7EF476BC1F52170B02FA1DF0DDA39B60D51A50000000000FFFFFFFF0260090000000000001600145BE12624D08A2B424095D7C07221C33450D14BF1989E0000000000002251208D50AED5BC9D2E62D65E27AF2BC7A424AC1906DD2DC7A29B3D88B8C7BD5026E0000000000001012B80BB000000000000225120925F6E5D2F54928DBBF7C7B989E2D0E8B6023BAECE6B7AE6EFED0C4F548919994215C050929B74C1A04954B78B4B6035E97A5E078A5A0F28EC96D547BFEE9ACE803AC08418260ACA037F78AA845243F0E2E4C201F3360266F71C130A21535E670351F9FD790120BD2EB288281A9E7A15EC81B8B593F243B96FBCD2B16A1A509C1B87DF95FC499CAD20D23C2C25E1FCF8FD1C21B9A402C19E2E309E531E45E92FB1E9805B6056B0CC76AD200AEE0509B16DB71C999238A4827DB945526859B13C95487AB46725357C9A9F25AC20113C3A32A9D320B72190A04A020A0DB3976EF36972673258E9A38A364F3DC3B0BA2017921CF156CCB4E73D428F996ED11B245313E37E27C978AC4D2CC21ECA4672E4BA203BB93DFC8B61887D771F3630E9A63E97CBAFCFCC78556A474DF83A31A0EF899CBA2040AFAF47C4FFA56DE86410D8E47BAA2BB6F04B604F4EA24323737DDC3FE092DFBA2079A71FFD71C503EF2E2F91BCCFC8FCDA7946F4653CEF0D9F3DDE20795EF3B9F0BA20D21FAF78C6751A0D38E6BD8028B907FF07E9A869A43FC837D6B3F8DFF6119A36BA20F5199EFAE3F28BB82476163A7E458C7AD445D9BFFB0682D10D3BDB2CB41F8E8EBA20FA9D882D45F4060BDB8042183828CD87544F1EA997380E586CAB77D5FD698737BA569CC001172050929B74C1A04954B78B4B6035E97A5E078A5A0F28EC96D547BFEE9ACE803AC0000000 
            05                          # unsigned(5)
            66                          # text(6)
               4E4752415645             # "NGRAVE"
```

- UR encoding

```
ur:batch-sign-request/oyadlstaoysronadtpdagdfrghbbemhyftfebdmyvydacerfdnfhreaotaoyrhoeadayaoaeaxtantjooeadlncsghykaeykaeykaocyemrewytyaahdvajojkidjyzmadaeldaoaeaeaeadfyongawdtbftsoswmkkgmhiymoaywpvwwlfhdeuegrctmsreveaxjznlheflqdtladaeaeaeaezmzmzmzmaogdsraeaeaeaeaeaecpgycxpdbsvwdilkgmsgprvtnbsojodibwynctvswzwzfdeeimjnkisfbgfeeolkbbwpcmasutamaeaeaeaeaecpgycxjypkbkgewyztahdpbaiawetnhthenstyptolprfezstefmoemwaysedyvomehnfpaeaeaeaeaeadaddnehonataeaeaeaeaecpgycxjypkbkgewyztahdpbaiawetnhthenstyptolprfezstefmoemwaysedyvomehnfpadchcxrydmprlodecynnknbzwplyroremuwzfxrhjlrftdpaimcygdnscwlturmdztgansaeaeaeahiyglflgmfphffetaoysronadtpdagdchkewlsoeymnlpjevsoxrokifzkkfmcmaotaoyrhoeadayaoaeaxtantjooeadlncsghykaeykaeykaocyemrewytyaahkaonljojkidjyzmadaekiaoaeaeaeadkgetmswzntuyfpolskwfaapsleatluihkpzojnahlronbslurhspyawtfgparsgmaeaeaeaeaezmzmzmzmaossasaeaeaeaeaeaecmaebbhpvydsdktilednfwfzmdtsrtjpclsreegdttgrwnaaolaeaeaeaeaeaecpgycxlggdpltlrfntdmidtbhydipednstoxdkpscfamutdpstoendfslorostrygddsvtaeaeaeaeaeadaddngdsraeaeaeaeaeaecpgycxpdbsvwdilkgmsgprvtnbsojodibwynctvswzwzfdeeimjnkisfbgfeeolkbbwpcmfwbzrtgdmondjysenbgaghrllugrhnecwlknhyatlehtbsdewpmttlflrswynytolaftrtaynyhefywllkayuycprkbsatvthfkstibzqzkknladhshknnahsrehenfnnsiozezckkadcxrydmprlodecynnknbzwplyroremuwzfxrhjlrftdpaimcygdnscwlturmdztganspmcxtdfndwdavyztyazcceclrhoxaosenndmdynnguckfewldlpawllahphnhfpfsfkopmcxbkwyahaspajnrlcenlmoetoxlfkirhfegmishkpafnmdfdknqziodaeckenynedapscxbyfnfteypttecxrlclmhnbgeaobkbtqdmsjtwfinjpioeyhdwlotleengwfssrpfrdcxchmocewnhfsfqzvdfsfwmynljtttcwdkgubwvlkbdisokspsgtdwsacksgfgjpverdcxfrrhfsztluhslokiktctendywlolfmmssbpetksfksgoimflgtyaftehnbwsldnsrdcxfzpepeflsszmonjnvsiebetpvekgpkdnrpwtgrhngwgloefxcnjkkiuofhvtmourrdcxkkosctzcjsskaxwsdmdlmerftkspzttnkkfgwkihfnwsbtnefsuecxkkhywfrhwtrdcxtdctpeksswkpcybtetvaryladerhatzmatwlpdinoxfhspemtbqdyaurynbynyenrdcxykcfnnzsvlwzlurodkkocmftkbfelkkntyfetarszoamlfttbtfruydwqzctmnmnrdcxzsntlodpfewkambduylafwcsetdesnltghgwckptmsetbahdjzpykttlzcinltemrdhfnsrtadchcxgdmondjysenbgaghrllugrhnecwlknhyatlehtbsdewpmttlflrswynytolaftrtaeaeaeahiyglflgmfphffetaoysronadtpdagdmeesdwwydelplnzotodavdpsfshfrelaaotaoyrhoeadayaoaeaxtantjooeadlncsghykaeykaeykaocyemrewytyaahkaonljojkidjyzmadaekiaoaeaeaeadkgkgdijlgyjtdykedslrrhredmvdwsfljeseykcljopfdloyurbttnesrpbtgyonaeaeaeaeaezmzmzmzmaohnasaeaeaeaeaeaecmaebbhpvydsdktilednfwfzmdtsrtjpclsreegdttgrwnmknnaeaeaeaeaeaecpgycxlggdpltlrfntdmidtbhydipednstoxdkpscfamutdpstoendfslorostrygddsvtaeaeaeaeaeadaddnlarkaeaeaeaeaeaecpgycxmohejthldlghmolgrkylstrhldvotivsrpaofrpltojeknvawswebngwghldcfnlfwbzrtgdmondjysenbgaghrllugrhnecwlknhyatlehtbsdewpmttlflrswynytolaftrtlrcsdsbksgaxlbkspklrgmfxwtvovesaadwfenaoiyylcebwbkclguhyioaxgyytzckkadcxrydmprlodecynnknbzwplyroremuwzfxrhjlrftdpaimcygdnscwlturmdztganspmcxtdfndwdavyztyazcceclrhoxaosenndmdynnguckfewldlpawllahphnhfpfsfkopmcxbkwyahaspajnrlcenlmoetoxlfkirhfegmishkpafnmdfdknqziodaeckenynedapscxbyfnfteypttecxrlclmhnbgeaobkbtqdmsjtwfinjpioeyhdwlotleengwfssrpfrdcxchmocewnhfsfqzvdfsfwmynljtttcwdkgubwvlkbdisokspsgtdwsacksgfgjpverdcxfrrhfsztluhslokiktctendywlolfmmssbpetksfksgoimflgtyaftehnbwsldnsrdcxfzpepeflsszmonjnvsiebetpvekgpkdnrpwtgrhngwgloefxcnjkkiuofhvtmourrdcxkkosctzcjsskaxwsdmdlmerftkspzttnkkfgwkihfnwsbtnefsuecxkkhywfrhwtrdcxtdctpeksswkpcybtetvaryladerhatzmatwlpdinoxfhspemtbqdyaurynbynyenrdcxykcfnnzsvlwzlurodkkocmftkbfelkkntyfetarszoamlfttbtfruydwqzctmnmnrdcxzsntlodpfewkambduylafwcsetdesnltghgwckptmsetbahdjzpykttlzcinltemrdhfnsrtadchcxgdmondjysenbgaghrllugrhnecwlknhyatlehtbsdewpmttlflrswynytolaftrtaeaeaeahiyglflgmfphffedmuretlf
```

### BTC batch signature response

- Signed PSBTs

```
- Signed PSBT 1
0x010000000001018d316a65c6f0eea072c2989f871735c32f04678194c2a5f9554a379b5e388fe00d00000000ffffffff029f9ac9010000000022512067d523235b08277f7a44e37be63604e6b1115f1eb55e75f30e78801276f0ab221027000000000000225120b1ce0aa1bb94736696bfaed973d07b40c7a7703e48b0e5357c354d2323a953950140b6afbaebfa0a16e81009c3466fa6440d33d5c2ba966eb1ba0641e50d436189b8c820d05ceda4d272bd93f69caafadf1b02b34ac40d88b38ee360ea036fb575e000000000

- Signed PSBT 2
0x010000000001017a108744cd533f74a9b4dc8670009e86afa01300d50d1b194bb494cc83491dfe3900000000ffffffff3b1027000000000000160014dc08142e239e1e5a7fdb99bb469a54b400f7a59610270000000000001600147ff1d1e26af90d707fc465bb41e044f0729d311c1027000000000000160014489151ad5a436376b9732cb4655c98a305fca2ea102700000000000016001488a1588122874abd11c8d2b65144680040b1a7cd10270000000000001600143eba1da1f10a1be008d1101bc1883b0a7e5e2ca5102700000000000016001458bb3080c6ca109b63b962f8597d4aebcdaa3eaf1027000000000000160014efd7f6d53bb8b2ce1aa09c248507ce143651760f102700000000000016001415d06d793cdbfd59fc098cb331530e788925e3071027000000000000160014498ff764ee246efc964b33f8ff1861fc893f37e5102700000000000016001476c4d55b3dbc4337d98f72bc2d68c4f51f37bf3a10270000000000001600141c9310f7248c7d4716f5d16d8bb1fd843fcef23a102700000000000016001404c6a512c4ef93da826e94f7a942c64d581351a51027000000000000160014af3133a287294f5b1dc24c465b9a5fa579cb73c91027000000000000225120b1ce0aa1bb94736696bfaed973d07b40c7a7703e48b0e5357c354d2323a9539510270000000000001600141afc8da4a999b350b9befd360046b2f264ac26f810270000000000001600145e30e0e5bcc66c6957baf092db70d3d2dca0cc2610270000000000001600148f5a5f8514b5ecf65da607d225c88f0faeb770dd10270000000000001600142f7a21f5e017973ddb4f69bfc773fa9d97c02bb41027000000000000160014246969164986dc86c5417c667874151298f0df111027000000000000160014285c8436082a5f32fb57bd0e39de25e8ff356f121027000000000000160014a62e9148fecc34a8720411e8e84dbf1f8c220a851027000000000000160014fa627a09765d518664f6057bba6dee36f1f22b571027000000000000160014cde8bff63e5d0442dac10a872404249211d13b67102700000000000016001483eeafe6a768f9a44e84864cfb6e2d8f4202471f10270000000000001600141c757662ce7779863974f26e7085afa56f2f7ab510270000000000001600142ac5abc89859f76608ff75add7258e2b87d8b4bb10270000000000001600141fccb7eb0800862613010e092f94618f64e9662f1027000000000000160014f9ccdaa1c3b057a3fd8b94691bd978752e2ef80e10270000000000001600147d38b4e80f80f5dba7e93a279a802a014a552c41102700000000000016001473ce7408a0a6acdf59398db617d219979a6651a8102700000000000016001463f2479c72d587fb69e1ae63861fe1a92755eb271027000000000000160014fd70c3524ceba103748698b0d6e5e4633deaf33d1027000000000000160014eb8adbe64201b20dc92c4fd59e1b59c38d4ad0fd10270000000000001600147078348397233697f40bb671026777cef88e99ae1027000000000000160014d9830fe466bc8d6d00b4c2ca89d22c51053f488310270000000000001600146af677d9911049d350cfe24186d083798b71dca51027000000000000160014f7e3508a9c0fe2aadd86d2f553b5793f5b03c40f1027000000000000160014d512b9be2b2494ed58b469d9313af8ee14f2ec830d4f600100000000225120b7d407b84f61037e7039c0eeab61c78ea3c73648a0f5ceba115d5fdb08d209a61027000000000000160014aec9529ca7b83b92ea23abbf8eb858a9eeff9b8410270000000000001600148b12683a2077c02af4902269b119ac71f28624fd1027000000000000160014b7c2d28b22e45887350dff89a0f6d628a9e972f91027000000000000160014f3f338643cc052592f0b36ac816b749f2839cf53102700000000000016001403a222e71444a9b4097efbad6a6288120082847610270000000000001600147607970390fd658a392c28dc6f26c76fc5cf9d8a1027000000000000160014304b43fc3eb251c8b7c265e970413fa60a57ecd2102700000000000016001417b27479f034b04e9269762e29d3017e61f1515f10270000000000001600146117b46f24248fb82089943122806b5d98a739231027000000000000160014595f6925db263b13e589a6c7f18e7a208b56963810270000000000001600140216e540f775fd4a4735de56a40dc196c1f4b9cb1027000000000000160014d4a919fd8c9d9ccc013f1d4b093a587920d5ca6b10270000000000001600147ef7b8d3ad7f8b849b8dccbace8f651c71f2fa301027000000000000160014a2ae0ff3b02d9dc64ed77dd30d9367dc9c73002b1027000000000000160014b6493e1858d44f8a4a8ec821bae99e8f6670d9791027000000000000160014aaefd375402cb6eed84d48612377b1c905a67d161027000000000000160014fe6cbc4f817df29a70b69c22fcab6da2a8a278d010270000000000001600144a580403ab01a77afb9b0366b37d891d9f106eb5102700000000000016001477ae5bb596616781f65ede2e77708640f24898e41027000000000000160014980127bd09507dfe7e194b0f7aa9bc7f319c03fc0140b348084250073ccf1f4823758b5570c953ec95277e6903decc296bc7a84608797bf8faeb9abd7742bf44f585a7d4255713bbf659d278874ab8f4b77c45073faf00000000

- Signed PSBT 3
0x020000000001018a9d867e06b7e8c7489d03bad1ec7961d4fd0f0688c5b8a7db85e9a7a3de00cf0000000000fdffffff0350c3000000000000225120811cddf3811b4964f07c3113e69a176c64c5dc3feae1e7b1cedcb4beb93632530000000000000000496a47626274340018ae1a089963cec3591e838513662cc8656fff796a30fe6eb0d0b30a8b59888bd23c2c25e1fcf8fd1c21b9a402c19e2e309e531e45e92fb1e9805b6056b0cc76fa005fc1000000000000225120b1ce0aa1bb94736696bfaed973d07b40c7a7703e48b0e5357c354d2323a953950140165722898670291f17663742a4baec8eab9c29ce36623876aeb8b21b5af6842459f98c2c5a1870b74b3c9e9c9010bbed9fed6f4244068a8275e654ad61c9d4fbd80f0300
```
- CBOR diagnosis format

```
{ 1: [ 41412({1: 37(h'3B5414375E3A450B8FE1251CBC2B3FB5'), ; request-id received for PSBT 1
              2: h'010000000001018d316a65c6f0eea072c2989f871735c32f04678194c2a5f9554a379b5e388fe00d00000000ffffffff029f9ac9010000000022512067d523235b08277f7a44e37be63604e6b1115f1eb55e75f30e78801276f0ab221027000000000000225120b1ce0aa1bb94736696bfaed973d07b40c7a7703e48b0e5357c354d2323a953950140b6afbaebfa0a16e81009c3466fa6440d33d5c2ba966eb1ba0641e50d436189b8c820d05ceda4d272bd93f69caafadf1b02b34ac40d88b38ee360ea036fb575e000000000', ; Signed PSBT 1
              3: "NGRAVE"}), ; wallet name
       41412({1: 37(h'177ce9c9328e856be8a4b87d40793e16'), ; request-id received for PSBT 2
              2: h'010000000001017a108744cd533f74a9b4dc8670009e86afa01300d50d1b194bb494cc83491dfe3900000000ffffffff3b1027000000000000160014dc08142e239e1e5a7fdb99bb469a54b400f7a59610270000000000001600147ff1d1e26af90d707fc465bb41e044f0729d311c1027000000000000160014489151ad5a436376b9732cb4655c98a305fca2ea102700000000000016001488a1588122874abd11c8d2b65144680040b1a7cd10270000000000001600143eba1da1f10a1be008d1101bc1883b0a7e5e2ca5102700000000000016001458bb3080c6ca109b63b962f8597d4aebcdaa3eaf1027000000000000160014efd7f6d53bb8b2ce1aa09c248507ce143651760f102700000000000016001415d06d793cdbfd59fc098cb331530e788925e3071027000000000000160014498ff764ee246efc964b33f8ff1861fc893f37e5102700000000000016001476c4d55b3dbc4337d98f72bc2d68c4f51f37bf3a10270000000000001600141c9310f7248c7d4716f5d16d8bb1fd843fcef23a102700000000000016001404c6a512c4ef93da826e94f7a942c64d581351a51027000000000000160014af3133a287294f5b1dc24c465b9a5fa579cb73c91027000000000000225120b1ce0aa1bb94736696bfaed973d07b40c7a7703e48b0e5357c354d2323a9539510270000000000001600141afc8da4a999b350b9befd360046b2f264ac26f810270000000000001600145e30e0e5bcc66c6957baf092db70d3d2dca0cc2610270000000000001600148f5a5f8514b5ecf65da607d225c88f0faeb770dd10270000000000001600142f7a21f5e017973ddb4f69bfc773fa9d97c02bb41027000000000000160014246969164986dc86c5417c667874151298f0df111027000000000000160014285c8436082a5f32fb57bd0e39de25e8ff356f121027000000000000160014a62e9148fecc34a8720411e8e84dbf1f8c220a851027000000000000160014fa627a09765d518664f6057bba6dee36f1f22b571027000000000000160014cde8bff63e5d0442dac10a872404249211d13b67102700000000000016001483eeafe6a768f9a44e84864cfb6e2d8f4202471f10270000000000001600141c757662ce7779863974f26e7085afa56f2f7ab510270000000000001600142ac5abc89859f76608ff75add7258e2b87d8b4bb10270000000000001600141fccb7eb0800862613010e092f94618f64e9662f1027000000000000160014f9ccdaa1c3b057a3fd8b94691bd978752e2ef80e10270000000000001600147d38b4e80f80f5dba7e93a279a802a014a552c41102700000000000016001473ce7408a0a6acdf59398db617d219979a6651a8102700000000000016001463f2479c72d587fb69e1ae63861fe1a92755eb271027000000000000160014fd70c3524ceba103748698b0d6e5e4633deaf33d1027000000000000160014eb8adbe64201b20dc92c4fd59e1b59c38d4ad0fd10270000000000001600147078348397233697f40bb671026777cef88e99ae1027000000000000160014d9830fe466bc8d6d00b4c2ca89d22c51053f488310270000000000001600146af677d9911049d350cfe24186d083798b71dca51027000000000000160014f7e3508a9c0fe2aadd86d2f553b5793f5b03c40f1027000000000000160014d512b9be2b2494ed58b469d9313af8ee14f2ec830d4f600100000000225120b7d407b84f61037e7039c0eeab61c78ea3c73648a0f5ceba115d5fdb08d209a61027000000000000160014aec9529ca7b83b92ea23abbf8eb858a9eeff9b8410270000000000001600148b12683a2077c02af4902269b119ac71f28624fd1027000000000000160014b7c2d28b22e45887350dff89a0f6d628a9e972f91027000000000000160014f3f338643cc052592f0b36ac816b749f2839cf53102700000000000016001403a222e71444a9b4097efbad6a6288120082847610270000000000001600147607970390fd658a392c28dc6f26c76fc5cf9d8a1027000000000000160014304b43fc3eb251c8b7c265e970413fa60a57ecd2102700000000000016001417b27479f034b04e9269762e29d3017e61f1515f10270000000000001600146117b46f24248fb82089943122806b5d98a739231027000000000000160014595f6925db263b13e589a6c7f18e7a208b56963810270000000000001600140216e540f775fd4a4735de56a40dc196c1f4b9cb1027000000000000160014d4a919fd8c9d9ccc013f1d4b093a587920d5ca6b10270000000000001600147ef7b8d3ad7f8b849b8dccbace8f651c71f2fa301027000000000000160014a2ae0ff3b02d9dc64ed77dd30d9367dc9c73002b1027000000000000160014b6493e1858d44f8a4a8ec821bae99e8f6670d9791027000000000000160014aaefd375402cb6eed84d48612377b1c905a67d161027000000000000160014fe6cbc4f817df29a70b69c22fcab6da2a8a278d010270000000000001600144a580403ab01a77afb9b0366b37d891d9f106eb5102700000000000016001477ae5bb596616781f65ede2e77708640f24898e41027000000000000160014980127bd09507dfe7e194b0f7aa9bc7f319c03fc0140b348084250073ccf1f4823758b5570c953ec95277e6903decc296bc7a84608797bf8faeb9abd7742bf44f585a7d4255713bbf659d278874ab8f4b77c45073faf00000000', ; Signed PSBT 2
              3: "NGRAVE"}), ; wallet name
       41412({1: 37(h'91392cee288586fbce25e7ac3d56b580'), ; request-id received for PSBT 3
              2: h'020000000001018a9d867e06b7e8c7489d03bad1ec7961d4fd0f0688c5b8a7db85e9a7a3de00cf0000000000fdffffff0350c3000000000000225120811cddf3811b4964f07c3113e69a176c64c5dc3feae1e7b1cedcb4beb93632530000000000000000496a47626274340018ae1a089963cec3591e838513662cc8656fff796a30fe6eb0d0b30a8b59888bd23c2c25e1fcf8fd1c21b9a402c19e2e309e531e45e92fb1e9805b6056b0cc76fa005fc1000000000000225120b1ce0aa1bb94736696bfaed973d07b40c7a7703e48b0e5357c354d2323a953950140165722898670291f17663742a4baec8eab9c29ce36623876aeb8b21b5af6842459f98c2c5a1870b74b3c9e9c9010bbed9fed6f4244068a8275e654ad61c9d4fbd80f0300', ; Signed PSBT 3
              3: "NGRAVE"}) ; wallet name
]}
```

- CBOR encoding

```
A1                                      # map(1)
   01                                   # unsigned(1)
   83                                   # array(3)
      D9 A1C4                           # tag(41412)
         A3                             # map(3)
            01                          # unsigned(1)
            D8 25                       # tag(37)
               50                       # bytes(16)
                  3B5414375E3A450B8FE1251CBC2B3FB5 
            02                          # unsigned(2)
            58 CD                       # bytes(205)
               010000000001018D316A65C6F0EEA072C2989F871735C32F04678194C2A5F9554A379B5E388FE00D00000000FFFFFFFF029F9AC9010000000022512067D523235B08277F7A44E37BE63604E6B1115F1EB55E75F30E78801276F0AB221027000000000000225120B1CE0AA1BB94736696BFAED973D07B40C7A7703E48B0E5357C354D2323A953950140B6AFBAEBFA0A16E81009C3466FA6440D33D5C2BA966EB1BA0641E50D436189B8C820D05CEDA4D272BD93F69CAAFADF1B02B34AC40D88B38EE360EA036FB575E000000000 
            03                          # unsigned(3)
            66                          # text(6)
               4E4752415645             # "NGRAVE"
      D9 A1C4                           # tag(41412)
         A3                             # map(3)
            01                          # unsigned(1)
            D8 25                       # tag(37)
               50                       # bytes(16)
                  177CE9C9328E856BE8A4B87D40793E16 
            02                          # unsigned(2)
            59 07B4                     # bytes(1972)
               010000000001017A108744CD533F74A9B4DC8670009E86AFA01300D50D1B194BB494CC83491DFE3900000000FFFFFFFF3B1027000000000000160014DC08142E239E1E5A7FDB99BB469A54B400F7A59610270000000000001600147FF1D1E26AF90D707FC465BB41E044F0729D311C1027000000000000160014489151AD5A436376B9732CB4655C98A305FCA2EA102700000000000016001488A1588122874ABD11C8D2B65144680040B1A7CD10270000000000001600143EBA1DA1F10A1BE008D1101BC1883B0A7E5E2CA5102700000000000016001458BB3080C6CA109B63B962F8597D4AEBCDAA3EAF1027000000000000160014EFD7F6D53BB8B2CE1AA09C248507CE143651760F102700000000000016001415D06D793CDBFD59FC098CB331530E788925E3071027000000000000160014498FF764EE246EFC964B33F8FF1861FC893F37E5102700000000000016001476C4D55B3DBC4337D98F72BC2D68C4F51F37BF3A10270000000000001600141C9310F7248C7D4716F5D16D8BB1FD843FCEF23A102700000000000016001404C6A512C4EF93DA826E94F7A942C64D581351A51027000000000000160014AF3133A287294F5B1DC24C465B9A5FA579CB73C91027000000000000225120B1CE0AA1BB94736696BFAED973D07B40C7A7703E48B0E5357C354D2323A9539510270000000000001600141AFC8DA4A999B350B9BEFD360046B2F264AC26F810270000000000001600145E30E0E5BCC66C6957BAF092DB70D3D2DCA0CC2610270000000000001600148F5A5F8514B5ECF65DA607D225C88F0FAEB770DD10270000000000001600142F7A21F5E017973DDB4F69BFC773FA9D97C02BB41027000000000000160014246969164986DC86C5417C667874151298F0DF111027000000000000160014285C8436082A5F32FB57BD0E39DE25E8FF356F121027000000000000160014A62E9148FECC34A8720411E8E84DBF1F8C220A851027000000000000160014FA627A09765D518664F6057BBA6DEE36F1F22B571027000000000000160014CDE8BFF63E5D0442DAC10A872404249211D13B67102700000000000016001483EEAFE6A768F9A44E84864CFB6E2D8F4202471F10270000000000001600141C757662CE7779863974F26E7085AFA56F2F7AB510270000000000001600142AC5ABC89859F76608FF75ADD7258E2B87D8B4BB10270000000000001600141FCCB7EB0800862613010E092F94618F64E9662F1027000000000000160014F9CCDAA1C3B057A3FD8B94691BD978752E2EF80E10270000000000001600147D38B4E80F80F5DBA7E93A279A802A014A552C41102700000000000016001473CE7408A0A6ACDF59398DB617D219979A6651A8102700000000000016001463F2479C72D587FB69E1AE63861FE1A92755EB271027000000000000160014FD70C3524CEBA103748698B0D6E5E4633DEAF33D1027000000000000160014EB8ADBE64201B20DC92C4FD59E1B59C38D4AD0FD10270000000000001600147078348397233697F40BB671026777CEF88E99AE1027000000000000160014D9830FE466BC8D6D00B4C2CA89D22C51053F488310270000000000001600146AF677D9911049D350CFE24186D083798B71DCA51027000000000000160014F7E3508A9C0FE2AADD86D2F553B5793F5B03C40F1027000000000000160014D512B9BE2B2494ED58B469D9313AF8EE14F2EC830D4F600100000000225120B7D407B84F61037E7039C0EEAB61C78EA3C73648A0F5CEBA115D5FDB08D209A61027000000000000160014AEC9529CA7B83B92EA23ABBF8EB858A9EEFF9B8410270000000000001600148B12683A2077C02AF4902269B119AC71F28624FD1027000000000000160014B7C2D28B22E45887350DFF89A0F6D628A9E972F91027000000000000160014F3F338643CC052592F0B36AC816B749F2839CF53102700000000000016001403A222E71444A9B4097EFBAD6A6288120082847610270000000000001600147607970390FD658A392C28DC6F26C76FC5CF9D8A1027000000000000160014304B43FC3EB251C8B7C265E970413FA60A57ECD2102700000000000016001417B27479F034B04E9269762E29D3017E61F1515F10270000000000001600146117B46F24248FB82089943122806B5D98A739231027000000000000160014595F6925DB263B13E589A6C7F18E7A208B56963810270000000000001600140216E540F775FD4A4735DE56A40DC196C1F4B9CB1027000000000000160014D4A919FD8C9D9CCC013F1D4B093A587920D5CA6B10270000000000001600147EF7B8D3AD7F8B849B8DCCBACE8F651C71F2FA301027000000000000160014A2AE0FF3B02D9DC64ED77DD30D9367DC9C73002B1027000000000000160014B6493E1858D44F8A4A8EC821BAE99E8F6670D9791027000000000000160014AAEFD375402CB6EED84D48612377B1C905A67D161027000000000000160014FE6CBC4F817DF29A70B69C22FCAB6DA2A8A278D010270000000000001600144A580403AB01A77AFB9B0366B37D891D9F106EB5102700000000000016001477AE5BB596616781F65EDE2E77708640F24898E41027000000000000160014980127BD09507DFE7E194B0F7AA9BC7F319C03FC0140B348084250073CCF1F4823758B5570C953EC95277E6903DECC296BC7A84608797BF8FAEB9ABD7742BF44F585A7D4255713BBF659D278874AB8F4B77C45073FAF00000000 
            03                          # unsigned(3)
            66                          # text(6)
               4E4752415645             # "NGRAVE"
      D9 A1C4                           # tag(41412)
         A3                             # map(3)
            01                          # unsigned(1)
            D8 25                       # tag(37)
               50                       # bytes(16)
                  91392CEE288586FBCE25E7AC3D56B580 
            02                          # unsigned(2)
            59 011F                     # bytes(287)
               020000000001018A9D867E06B7E8C7489D03BAD1EC7961D4FD0F0688C5B8A7DB85E9A7A3DE00CF0000000000FDFFFFFF0350C3000000000000225120811CDDF3811B4964F07C3113E69A176C64C5DC3FEAE1E7B1CEDCB4BEB93632530000000000000000496A47626274340018AE1A089963CEC3591E838513662CC8656FFF796A30FE6EB0D0B30A8B59888BD23C2C25E1FCF8FD1C21B9A402C19E2E309E531E45E92FB1E9805B6056B0CC76FA005FC1000000000000225120B1CE0AA1BB94736696BFAED973D07B40C7A7703E48B0E5357C354D2323A953950140165722898670291F17663742A4BAEC8EAB9C29CE36623876AEB8B21B5AF6842459F98C2C5A1870B74B3C9E9C9010BBED9FED6F4244068A8275E654AD61C9D4FBD80F0300 
            03                          # unsigned(3)
            66                          # text(6)
               4E4752415645             # "NGRAVE"
```

- UR encoding

```
ur:batch-sign-response/oyadlstaoyssotadtpdagdfrghbbemhyftfebdmyvydacerfdnfhreaohdsnadaeaeaeaeadadlgehimihswwtwynbjpsamkneltchecsrdlaaiolymwsaonytgogeemndhyetmyvtbtaeaeaeaezmzmzmzmaonenysoadaeaeaeaecpgycxiotlcncnhpaydilbknfyvlkgvaenaavapabyheckrehykpwfbakslabgkowtpycpbediaeaeaeaeaeaecpgycxpatobkoyrkmwjkiymtrspltajktikgfzstosjofmfdpfvweckeecgtcncnptgumdadfzrpperdwmzsbkcmvsbeassrfgjlolfybteotlsardmtjtpardamfpvwbtfxhsldrospcxtihhweoxtdjprymuynnspkzsurcwaoqdgessbtloqdmnvlhnwdaxjlrekpvtaeaeaeaeaxiyglflgmfphffetaoyssotadtpdagdchkewlsoeymnlpjevsoxrokifzkkfmcmaohkatqzadaeaeaeaeadadknbeltfysngufhjyptqzuolnjoaennlnpenbbwaetlbtcwcfgrqzmwsflsgacazeesaeaeaeaezmzmzmzmfrbediaeaeaeaeaeaecmaebbuoaybbdmcnnnckhtlbuynlrkfgnyghqzaeylonmtbediaeaeaeaeaeaecmaebblbwnttvoimytbtjolbssihrkfpvtfywtjpntehcebediaeaeaeaeaeaecmaebbfdmegypmhtfxiakorhjkdwqzihhhmkotahztoewdbediaeaeaeaeaeaecmaebblooyhdlycpltgerybysptdrpgyfyisaefzpaossnbediaeaeaeaeaeaecmaebbfmrdcaoywnbkcwvtayttbecwselofrbkkbhydwonbediaeaeaeaeaeaecmaebbhdrkdylaswsgbendiarhidyahkkigewmsnpkfmpebediaeaeaeaeaeaecmaebbwstsyntlfrroprtocynbnsdklpattobbengykobsbediaeaeaeaeaeaecmaebbbztijnkkfnuyzchkztaslkqdehgubakslddavlatbediaeaeaeaeaeaecmaebbgamyyliewydkjtztmtgreoyazmcshsztldfhemvwbediaeaeaeaeaeaecmaebbkosstlhpfsrffxemtamyjprfdpisssykctemrsftbediaeaeaeaeaeaecmaebbcemubeyldklkkiflcmykttjnlupazclrfhtowzftbediaeaeaeaeaeaecmaebbaaswonbgsswsmutnlfjtmwylptfwswgthdbwgyonbediaeaeaeaeaeaecmaebbpeeheooeltdtgwhpcasagsfghpnyheonkksbjksobediaeaeaeaeaeaecpgycxpatobkoyrkmwjkiymtrspltajktikgfzstosjofmfdpfvweckeecgtcncnptgumdbediaeaeaeaeaeaecmaebbcyztlgoxptnlqdgdrhrnzcenaefgprwziepsdsyabediaeaeaeaeaeaecmaebbhydyvtvwrfswjzinhgrdwtmouyjotetduonbsfdsbediaeaeaeaeaeaecmaebbmyhthelpbbrewpynhlolattddaspmybsplrljoutbediaeaeaeaeaeaecmaebbdlknclykvtchmsfsuygwinrsstjkzsntmsrtdnqzbediaeaeaeaeaeaecmaebbdkinincmgalnuolnskfpkeiyksjybzbgmkwturbybediaeaeaeaeaeaecmaebbdehhlrenaydrheeyzohgrybaesuedavszmecjlbgbediaeaeaeaeaeaecmaebboldmmefdzesfeepdjpaabyvsvsgtrsctlkcpbklpbediaeaeaeaeaeaecmaebbzsidknaskohlgylnieynahkgrdjnwyenwnwzdnhgbediaeaeaeaeaeaecmaebbsnvsrsynfmhlaafwtnsebkltdkaadkmobyttfriobediaeaeaeaeaeaecmaebblswypevaosisytoxgllrlngszojtdpmyfwaoflctbediaeaeaeaeaeaecmaebbcekpkoidtoktkklnesjywzjtjolppeonjldlknrebediaeaeaeaeaeaecmaebbdrskpyspmkhkyliyayzmkppmtsdamndnlttpqzrkbediaeaeaeaeaeaecmaebbctsfrlwmayaelndsbwadbaasdlmwhsmyiewliydlbediaeaeaeaeaeaecmaebbytsftnoysrpfhgotzclumwincwtakskpdmdmyababediaeaeaeaeaeaecmaebbkietqzvsbslaykuyoswlftdinyladradgegodwfpbediaeaeaeaeaeaecmaebbjktojyaynbolpsurhkeslgrpchtdcfmsnyiygypdbediaeaeaeaeaeaecmaebbiawzflnsjptlltzoinvyplialnctvyptdigowmdibediaeaeaeaeaeaecmaebbzcjosrgmgswmoyaxjylnmkpftbvwveiafswdwffsbediaeaeaeaeaeaecmaebbwmleuyvafwadprbtsodwgwtlnncwhksrlggetizcbediaeaeaeaeaeaecmaebbjokseelsmscnenmswkbdrpjsaoiokttoyamnnlplbediaeaeaeaeaeaecmaebbtalsbsveiyrflgjnaeqzsasgldtddwgyahfhfdlsbediaeaeaeaeaeaecmaebbimynkttamebegategdtkvofplntilskklujsuoonbediaeaeaeaeaeaecmaebbylvlgdlensbsvopkutlntdykgurekkfhhpaxssbsbediaeaeaeaeaeaecmaebbtlbgrhrndndkmwwehdqzintaehftyawybbwzwplsbtgwhnadaeaeaeaecpgycxrltyatrogwhsaxkbjoesrtwypyhsstmnotstenfdnbyktordbyhlheuyaytdasolbediaeaeaeaeaeaecmaebbplsogmnsosrofrmowdcnpyrsmnrohdptwyzmndlrbediaeaeaeaeaeaecmaebblubgisftcxktrtdrwkmhcpinpacfpsjswzlndkzcbediaeaeaeaeaeaecmaebbrlsatdlucpvehdltecbtzmldnbyntbdeptwljpytbediaeaeaeaeaeaecmaebbwfwfetiefnrtgmhkdlbdenpslyjejynedeestkgubediaeaeaeaeaeaecmaebbaxoecpvdbbfyptqzaskbzopmimidlobgaelflrkobediaeaeaeaeaeaecmaebbkoatmsaxmhzcihleesdwdeuojldsstjlsktkntlebediaeaeaeaeaeaecmaebbdygrfxztfmprgysprlsaihwljofpfholbkhgwptdbediaeaeaeaeaeaecmaebbchprjykkwteepfglmoinkodmdtteadkbhswngyhebediaeaeaeaeaeaecmaebbhschqzjldkdkmyrocxldmwehcplajehlmkosescnbediaeaeaeaeaeaecmaebbhkheindauydsfrbwvwldolstwnmnkncxluhfmtetbediaeaeaeaeaeaecmaebbaocmvwfzylkpzcgeflecuehfoxbtsemtsewkrhsbbediaeaeaeaeaeaecmaebbtyptcfzclkntnssfadfhcagrasfthdkkcxtlsgjebediaeaeaeaeaeaecmaebbkbylrotepmlblulrndlgsfrdtomyihcejswzzsdybediaeaeaeaeaeaecmaebboeplbswfpfdpntswgltskitebtmuiouonsjkaednbediaeaeaeaeaeaecmaebbrpgafmcshdtygwlegemnspclrdwlnnmyiyjotakkbediaeaeaeaeaeaecmaebbpkwstekpfzdwrpwytpgtfdhscnktpasoaholkicmbediaeaeaeaeaeaecmaebbzejzrfgwlykiwznyjorpnscpztpyjnoepdoekstibediaeaeaeaeaeaecmaebbgehdaaaxpyadosknzondaxiyqdkildcanebejtrebediaeaeaeaeaeaecmaebbktplhpremthsiolyynhyuedmktjolnfzwzfdmkvebediaeaeaeaeaeaecmaebbmkaddiryasgdkizekbcfgrbsknptrflbehnsaxztadfzqdfdayfwgdatfntkctfdcnkplugojosoguwpmddikbinaxuesfdtjestpdfgaykkkgyazswmnyryktfwrsfyyklpostydahgbwrkynhktdksltgerowkrlkefeatfhpeaeaeaeaeaxiyglflgmfphffetaoyssotadtpdagdmeesdwwydelplnzotodavdpsfshfrelaaohkadctaoaeaeaeaeadadlentlnkbamrlvsstfdntaxrdttwpkkhstyzcbsamloskroosuylpwlosotueaetkaeaeaeaeaezczmzmzmaxgdsraeaeaeaeaeaecpgycxlyceutwflycwgaiewtkeehbwvanychjzieskuofhwdvyvdpatouoqzrnrheneyguaeaeaeaeaeaeaeaegaimflididjyeeaecsplcyaynliatosrhkcklslpbwiydwspihjlzmkkimdyzejtpftiqdbkluhklolutdfndwdavyztyazcceclrhoxaosenndmdynnguckfewldlpawllahphnhfpfsfkozsaeheseaeaeaeaeaeaecpgycxpatobkoyrkmwjkiymtrspltajktikgfzstosjofmfdpfvweckeecgtcncnptgumdadfzcmhgcpldlnjodtctchiyemfwoxrdwpmnpynsdttoenidetkoplroprcwhtynlrdkhkytlkdwhtcsjorlgrfnnnnsmhberkwenewejlfwfyamlelfkpvaghpmhssotyzotpbsaxaeaxiyglflgmfphffewpwdhfvy
```

### Extended use case to batch signing on different blockchains

By introducing arrays of blockchain-agnostic signing requests and signature responses within the batch UR types, a single batch can encompass transactions across multiple blockchains, fully leveraging the generic nature of the proposed UR types.

Consider the Babylon protocol [[Babylon/docs/register-bitcoin-stake]](https://github.com/babylonlabs-io/babylon/blob/main/docs/register-bitcoin-stake.md) as example: a batch could include a stake registration transaction on the Babylon chain alongside three PSBTs to initiate BTC staking. The user would only need to scan a single QR code with the offline signer to review the content of all four transactions—three PSBTs and one Babylon chain transaction. After verifying the transaction details, the user can broadcast all the signatures by scanning a single QR code with the watch-only wallet. This streamlined process enhances efficiency and security by minimizing the number of interactions required, while supporting diverse blockchain operations within a unified framework.

---

# III - Considerations

## Handling duplicated request IDs in Batch signing

In the typical scenario, each sign-request within the array of batch-sign-requests corresponds to a specific sign-response in the array of batch-sign-responses, identified through a unique request-id. This one-to-one mapping ensures that each request is matched with its respective response, facilitating straightforward processing and verification. 

However, it is not always the case that the number of elements in the batch-sign-request array corresponds exactly to the number of elements in the batch-sign-response array. Discrepancies can occur where the request-id is duplicated, linking one sign-request to multiple sign-responses, or vice versa. Such variations must be carefully managed to maintain the integrity and accuracy of the batch signing process, ensuring that all transactions are properly authorized and accounted for.

## Batch size limitation

Due to the limited memory capacity of the offline signing device, the batch size for transaction signing is constrained. The device should clearly indicate to the user when the maximum memory threshold is reached, ensuring that the signing process does not exceed its capabilities. In such cases, the watch-only wallet should propose alternative solutions, such as signing a smaller batch of transactions or processing each transaction individually. This approach maintains the integrity and security of the signing process while accommodating the device's limitations, providing a seamless user experience.

## Security consideration

When signing a batch of transactions, security is paramount. It is crucial to decode and display the content of each transaction included in the batch to ensure transparency and accuracy. This step allows the user to verify the details of each transaction before proceeding with the signing process. 

Additionally, if any single transaction within the batch is rejected or deemed invalid, the entire batch signing process should be aborted. This measure prevents partial or incorrect signings. By adhering to these considerations, users can confidently sign multiple transactions in a batch without compromising security.

---

# IV - References

| Reference | Link |
| --- | --- |
| [NBCR-2023-003] | https://github.com/ngraveio/Research/blob/main/papers/nbcr-2023-003-sign.md |
| [Babylon/docs/register-bitcoin-stake] | https://github.com/babylonlabs-io/babylon/blob/main/docs/register-bitcoin-stake.md |